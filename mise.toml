[tools]
rust = "stable"
node = "lts"
python = "latest"
yarn = "1.22.19"

[tasks.default]
alias = "build"

[tasks.build]
description = "Build the project"
run = "cargo build --release"

[tasks.test]
description = "Run all tests"
run = [
    "cargo test --workspace --exclude setheum-js",
    "cd setheum-js && yarn install && yarn test"
]

[tasks.fmt]
description = "Format the codebase"
run = [
    "cargo fmt --all",
    "python3 scripts/apply_headers.py"
]

[tasks.headers]
description = "Apply headers"
run = "python3 scripts/apply_headers.py"

[tasks.clean]
description = "Clean build artifacts"
run = [
    "cargo clean",
    "rm -rf target/"
]

[tasks."prdoc:scaffold"]
description = "Generate draft PRDocs from git history"
run = "python3 scripts/prdoc.py scaffold {{args}}"

[tasks."prdoc:validate"]
description = "Validate all .prdoc files"
run = "python3 scripts/prdoc.py validate"

[tasks."prdoc:generate"]
description = "Generate CHANGELOG entries from PRDocs"
run = "python3 scripts/prdoc.py generate"

[tasks.all]
description = "Default build task"
depends = ["build"]
